{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/src/components/LogoutButton.jsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { LogOut } from 'lucide-react';\r\n\r\nexport default function LogoutButton() {\r\n  const router = useRouter();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      // ========================================\r\n      // CLEAR CLIENT-SIDE DATA\r\n      // ========================================\r\n      \r\n      // Clear localStorage\r\n      localStorage.removeItem('user');\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('authToken');\r\n      \r\n      // Clear sessionStorage\r\n      sessionStorage.removeItem('user');\r\n      sessionStorage.removeItem('token');\r\n      sessionStorage.removeItem('authToken');\r\n      \r\n      // Clear all localStorage items (just to be safe)\r\n      try {\r\n        const keys = Object.keys(localStorage);\r\n        keys.forEach(key => {\r\n          if (key.includes('auth') || key.includes('user') || key.includes('token')) {\r\n            localStorage.removeItem(key);\r\n          }\r\n        });\r\n      } catch (e) {\r\n        console.warn('Could not clear all localStorage items:', e);\r\n      }\r\n\r\n      // ========================================\r\n      // CALL LOGOUT API\r\n      // ========================================\r\n      \r\n      // Call the logout API endpoint\r\n      const response = await fetch('/api/auth/logout', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        // Prevent caching of this request\r\n        cache: 'no-store',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to logout');\r\n      }\r\n\r\n      // ========================================\r\n      // REDIRECT AND REFRESH\r\n      // ========================================\r\n      \r\n      // Redirect to login page\r\n      router.push('/login');\r\n      \r\n      // Force refresh to clear all server-side session data\r\n      router.refresh();\r\n      \r\n      // Additional measure: clear browser history for protected pages\r\n      if (window.history && window.history.length > 1) {\r\n        window.history.replaceState(null, '', '/login');\r\n      }\r\n    } catch (err) {\r\n      console.error('Logout error:', err);\r\n      setError(err.message || 'Failed to logout. Please try again.');\r\n      \r\n      // Even if logout fails, redirect to login as a fallback\r\n      setTimeout(() => {\r\n        router.push('/login');\r\n        router.refresh();\r\n      }, 1500);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <button\r\n      onClick={handleLogout}\r\n      disabled={isLoading}\r\n      className=\"flex items-center gap-2 px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed\"\r\n      title={error ? error : 'Click to logout'}\r\n    >\r\n      <LogOut className=\"w-4 h-4\" />\r\n      {isLoading ? 'Logging out...' : 'Logout'}\r\n    </button>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAMe,SAAS;;IACtB,MAAM,SAAS,IAAA,sMAAS;IACxB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6NAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAC;IAEnC,MAAM,eAAe;QACnB,IAAI;YACF,aAAa;YACb,SAAS;YAET,2CAA2C;YAC3C,yBAAyB;YACzB,2CAA2C;YAE3C,qBAAqB;YACrB,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YAExB,uBAAuB;YACvB,eAAe,UAAU,CAAC;YAC1B,eAAe,UAAU,CAAC;YAC1B,eAAe,UAAU,CAAC;YAE1B,iDAAiD;YACjD,IAAI;gBACF,MAAM,OAAO,OAAO,IAAI,CAAC;gBACzB,KAAK,OAAO,CAAC,CAAA;oBACX,IAAI,IAAI,QAAQ,CAAC,WAAW,IAAI,QAAQ,CAAC,WAAW,IAAI,QAAQ,CAAC,UAAU;wBACzE,aAAa,UAAU,CAAC;oBAC1B;gBACF;YACF,EAAE,OAAO,GAAG;gBACV,QAAQ,IAAI,CAAC,2CAA2C;YAC1D;YAEA,2CAA2C;YAC3C,kBAAkB;YAClB,2CAA2C;YAE3C,+BAA+B;YAC/B,MAAM,WAAW,MAAM,MAAM,oBAAoB;gBAC/C,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,kCAAkC;gBAClC,OAAO;YACT;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,2CAA2C;YAC3C,uBAAuB;YACvB,2CAA2C;YAE3C,yBAAyB;YACzB,OAAO,IAAI,CAAC;YAEZ,sDAAsD;YACtD,OAAO,OAAO;YAEd,gEAAgE;YAChE,IAAI,OAAO,OAAO,IAAI,OAAO,OAAO,CAAC,MAAM,GAAG,GAAG;gBAC/C,OAAO,OAAO,CAAC,YAAY,CAAC,MAAM,IAAI;YACxC;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,iBAAiB;YAC/B,SAAS,IAAI,OAAO,IAAI;YAExB,wDAAwD;YACxD,WAAW;gBACT,OAAO,IAAI,CAAC;gBACZ,OAAO,OAAO;YAChB,GAAG;QACL,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,iPAAC;QACC,SAAS;QACT,UAAU;QACV,WAAU;QACV,OAAO,QAAQ,QAAQ;;0BAEvB,iPAAC,2QAAM;gBAAC,WAAU;;;;;;YACjB,YAAY,mBAAmB;;;;;;;AAGtC;GA7FwB;;QACP,sMAAS;;;KADF","debugId":null}},
    {"offset": {"line": 123, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/src/components/NotificationDropdown.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport Link from 'next/link';\r\nimport { Bell, X, Trash2 } from 'lucide-react';\r\n\r\ninterface Notification {\r\n  id: number;\r\n  type: string;\r\n  title: string;\r\n  message: string;\r\n  link?: string;\r\n  isRead: boolean;\r\n  createdAt: string;\r\n}\r\n\r\nexport default function NotificationDropdown() {\r\n  const [notifications, setNotifications] = useState<Notification[]>([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const dropdownRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    fetchNotifications();\r\n    const interval = setInterval(fetchNotifications, 30000); // Poll every 30 seconds\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n\r\n    if (isOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const fetchNotifications = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await fetch('/api/notifications/list?limit=20&offset=0');\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setNotifications(data.notifications || []);\r\n        setUnreadCount(data.unreadCount || 0);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to fetch notifications:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const markAsRead = async (notificationId: number) => {\r\n    try {\r\n      await fetch('/api/notifications/mark-read', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ notificationId }),\r\n      });\r\n\r\n      setNotifications(\r\n        notifications.map((n) =>\r\n          n.id === notificationId ? { ...n, isRead: true } : n\r\n        )\r\n      );\r\n      setUnreadCount(Math.max(0, unreadCount - 1));\r\n    } catch (error) {\r\n      console.error('Failed to mark notification as read:', error);\r\n    }\r\n  };\r\n\r\n  const deleteNotification = async (notificationId: number, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    try {\r\n      await fetch('/api/notifications/delete', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ notificationId }),\r\n      });\r\n\r\n      setNotifications(notifications.filter((n) => n.id !== notificationId));\r\n    } catch (error) {\r\n      console.error('Failed to delete notification:', error);\r\n    }\r\n  };\r\n\r\n  // Format relative time\r\n  const formatRelativeTime = (dateString: string): string => {\r\n    const date = new Date(dateString);\r\n    const now = new Date();\r\n    const seconds = Math.floor((now.getTime() - date.getTime()) / 1000);\r\n\r\n    if (seconds < 60) return 'just now';\r\n    if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;\r\n    if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;\r\n    if (seconds < 604800) return `${Math.floor(seconds / 86400)}d ago`;\r\n    \r\n    return date.toLocaleDateString();\r\n  };\r\n\r\n  // Get notification color based on type\r\n  const getNotificationColor = (type: string): string => {\r\n    switch (type) {\r\n      case 'match':\r\n        return 'bg-blue-100 text-blue-600';\r\n      case 'found':\r\n        return 'bg-green-100 text-green-600';\r\n      case 'message':\r\n        return 'bg-purple-100 text-purple-600';\r\n      case 'badge':\r\n        return 'bg-yellow-100 text-yellow-600';\r\n      case 'reminder':\r\n        return 'bg-orange-100 text-orange-600';\r\n      case 'nearby':\r\n        return 'bg-pink-100 text-pink-600';\r\n      default:\r\n        return 'bg-gray-100 text-gray-600';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative\" ref={dropdownRef}>\r\n      {/* Bell Icon Button */}\r\n      <button\r\n        onClick={() => setIsOpen(!isOpen)}\r\n        className=\"relative p-2 hover:bg-gray-100 rounded-lg transition-colors\"\r\n        title=\"Notifications\"\r\n      >\r\n        <Bell className=\"w-6 h-6 text-gray-700\" />\r\n\r\n        {/* Unread Count Badge */}\r\n        {unreadCount > 0 && (\r\n          <span className=\"absolute top-1 right-1 inline-flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-red-600 rounded-full\">\r\n            {unreadCount > 9 ? '9+' : unreadCount}\r\n          </span>\r\n        )}\r\n      </button>\r\n\r\n      {/* Dropdown Menu */}\r\n      {isOpen && (\r\n        <div className=\"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-2xl border border-gray-200 z-50\">\r\n          {/* Header */}\r\n          <div className=\"bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-4 py-3 rounded-t-lg flex items-center justify-between\">\r\n            <h3 className=\"font-semibold\">Notifications</h3>\r\n            <button\r\n              onClick={() => setIsOpen(false)}\r\n              className=\"p-1 hover:bg-white/20 rounded-lg transition-colors\"\r\n            >\r\n              <X className=\"w-5 h-5\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Notifications List */}\r\n          <div className=\"max-h-96 overflow-y-auto\">\r\n            {loading ? (\r\n              <div className=\"p-4 text-center text-gray-500\">\r\n                <div className=\"inline-block w-6 h-6 border-2 border-gray-300 border-t-indigo-600 rounded-full animate-spin\" />\r\n              </div>\r\n            ) : notifications.length === 0 ? (\r\n              <div className=\"p-8 text-center\">\r\n                <Bell className=\"w-12 h-12 text-gray-300 mx-auto mb-2\" />\r\n                <p className=\"text-gray-500 text-sm\">No notifications yet</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"divide-y divide-gray-200\">\r\n                {notifications.map((notification) => (\r\n                  <div\r\n                    key={notification.id}\r\n                    className={`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${\r\n                      !notification.isRead ? 'bg-blue-50' : ''\r\n                    }`}\r\n                    onClick={() => {\r\n                      if (!notification.isRead) {\r\n                        markAsRead(notification.id);\r\n                      }\r\n                      if (notification.link) {\r\n                        window.location.href = notification.link;\r\n                      }\r\n                    }}\r\n                  >\r\n                    <div className=\"flex items-start gap-3\">\r\n                      {/* Type Icon */}\r\n                      <div className={`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold ${getNotificationColor(notification.type)}`}>\r\n                        {notification.type.charAt(0).toUpperCase()}\r\n                      </div>\r\n\r\n                      {/* Content */}\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <p className=\"font-semibold text-gray-800 text-sm\">\r\n                          {notification.title}\r\n                        </p>\r\n                        <p className=\"text-gray-600 text-sm mt-1 line-clamp-2\">\r\n                          {notification.message}\r\n                        </p>\r\n                        <p className=\"text-xs text-gray-500 mt-1\">\r\n                          {formatRelativeTime(notification.createdAt)}\r\n                        </p>\r\n                      </div>\r\n\r\n                      {/* Delete Button */}\r\n                      <button\r\n                        onClick={(e) => deleteNotification(notification.id, e)}\r\n                        className=\"flex-shrink-0 p-1 hover:bg-red-100 rounded transition-colors text-gray-400 hover:text-red-600\"\r\n                      >\r\n                        <Trash2 className=\"w-4 h-4\" />\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          {notifications.length > 0 && (\r\n            <div className=\"bg-gray-50 px-4 py-3 rounded-b-lg border-t border-gray-200\">\r\n              <Link\r\n                href=\"/notifications\"\r\n                className=\"text-sm text-indigo-600 hover:text-indigo-700 font-semibold flex items-center justify-center\"\r\n              >\r\n                View All Notifications â†’\r\n              </Link>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 491, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/src/components/MatchCard.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport Image from 'next/image';\r\nimport { CheckCircle, MapPin, Calendar } from 'lucide-react';\r\n\r\ninterface ItemData {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  category: string;\r\n  imageUrls: string[];\r\n  locationLost?: string;\r\n  locationFound?: string;\r\n  dateLost?: string;\r\n  dateFound?: string;\r\n  user: {\r\n    id: number;\r\n    name: string;\r\n    email: string;\r\n    profileImage?: string;\r\n  };\r\n}\r\n\r\ninterface MatchCardProps {\r\n  matchId: number;\r\n  score: number;\r\n  lostItem: ItemData;\r\n  foundItem: ItemData;\r\n  isLostItemOwner: boolean;\r\n  status: 'pending' | 'confirmed' | 'rejected';\r\n  onConfirm: (matchId: number) => Promise<void>;\r\n}\r\n\r\nexport default function MatchCard({\r\n  matchId,\r\n  score,\r\n  lostItem,\r\n  foundItem,\r\n  isLostItemOwner,\r\n  status,\r\n  onConfirm,\r\n}: MatchCardProps) {\r\n  const [isConfirming, setIsConfirming] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const scorePercentage = Math.round(score * 100);\r\n  const otherItem = isLostItemOwner ? foundItem : lostItem;\r\n  const otherUser = otherItem.user;\r\n\r\n  const handleConfirm = async () => {\r\n    try {\r\n      setIsConfirming(true);\r\n      setError(null);\r\n      await onConfirm(matchId);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to confirm match');\r\n    } finally {\r\n      setIsConfirming(false);\r\n    }\r\n  };\r\n\r\n  // Determine location to display\r\n  const itemLocation = isLostItemOwner\r\n    ? foundItem.locationFound || foundItem.locationLost || 'Unknown location'\r\n    : lostItem.locationLost || lostItem.locationFound || 'Unknown location';\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-xl shadow-md hover:shadow-lg transition-shadow border border-gray-200 overflow-hidden\">\r\n      <div className=\"grid md:grid-cols-2 gap-6 p-6\">\r\n        {/* Item Image & Info */}\r\n        <div>\r\n          <div className=\"relative w-full h-64 bg-gray-100 rounded-lg overflow-hidden mb-4\">\r\n            {otherItem.imageUrls && otherItem.imageUrls.length > 0 ? (\r\n              <Image\r\n                src={otherItem.imageUrls[0]}\r\n                alt={otherItem.title}\r\n                fill\r\n                className=\"object-cover\"\r\n              />\r\n            ) : (\r\n              <div className=\"w-full h-full flex items-center justify-center bg-gradient-to-br from-gray-200 to-gray-300\">\r\n                <span className=\"text-gray-500 text-sm\">No image</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <h3 className=\"text-xl font-bold text-gray-800 mb-2\">{otherItem.title}</h3>\r\n          <p className=\"text-gray-600 text-sm mb-4 line-clamp-2\">{otherItem.description}</p>\r\n\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex items-center gap-2 text-gray-700\">\r\n              <MapPin className=\"w-4 h-4 text-indigo-600\" />\r\n              <span className=\"text-sm\">{itemLocation}</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2 text-gray-700\">\r\n              <Calendar className=\"w-4 h-4 text-indigo-600\" />\r\n              <span className=\"text-sm\">\r\n                {isLostItemOwner && foundItem.dateFound\r\n                  ? new Date(foundItem.dateFound).toLocaleDateString()\r\n                  : lostItem.dateLost\r\n                  ? new Date(lostItem.dateLost).toLocaleDateString()\r\n                  : 'Unknown date'}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Match Score & Other User Info */}\r\n        <div className=\"flex flex-col justify-between\">\r\n          {/* Score Section */}\r\n          <div>\r\n            <h4 className=\"text-lg font-semibold text-gray-800 mb-3\">Match Score</h4>\r\n\r\n            {/* Score Progress Bar */}\r\n            <div className=\"mb-4\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <span className=\"text-sm font-medium text-gray-700\">Similarity</span>\r\n                <span className=\"text-lg font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent\">\r\n                  {scorePercentage}%\r\n                </span>\r\n              </div>\r\n              <div className=\"w-full bg-gray-200 rounded-full h-3 overflow-hidden\">\r\n                <div\r\n                  className=\"h-full bg-gradient-to-r from-indigo-600 to-purple-600 transition-all duration-500\"\r\n                  style={{ width: `${scorePercentage}%` }}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {scorePercentage >= 85 && (\r\n              <p className=\"text-sm text-green-600 font-medium mb-4\">ðŸŽ¯ High confidence match!</p>\r\n            )}\r\n            {scorePercentage >= 70 && scorePercentage < 85 && (\r\n              <p className=\"text-sm text-amber-600 font-medium mb-4\">Good match potential</p>\r\n            )}\r\n          </div>\r\n\r\n          {/* Other User Info */}\r\n          <div className=\"bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg p-4 mb-4\">\r\n            <p className=\"text-xs font-semibold text-gray-600 uppercase mb-2\">Contact Person</p>\r\n            <div className=\"flex items-center gap-3\">\r\n              {otherUser.profileImage && (\r\n                <img\r\n                  src={otherUser.profileImage}\r\n                  alt={otherUser.name}\r\n                  className=\"w-10 h-10 rounded-full object-cover\"\r\n                />\r\n              )}\r\n              <div>\r\n                <p className=\"font-semibold text-gray-800\">{otherUser.name}</p>\r\n                <p className=\"text-sm text-gray-600\">{otherUser.email}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Status & Action */}\r\n          <div>\r\n            {status === 'confirmed' ? (\r\n              <div className=\"flex items-center gap-2 bg-green-50 text-green-700 px-4 py-3 rounded-lg border border-green-200\">\r\n                <CheckCircle className=\"w-5 h-5\" />\r\n                <span className=\"font-medium\">Match Confirmed</span>\r\n              </div>\r\n            ) : (\r\n              <button\r\n                onClick={handleConfirm}\r\n                disabled={isConfirming}\r\n                className=\"w-full px-4 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold rounded-lg hover:from-indigo-700 hover:to-purple-700 transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {isConfirming ? 'Confirming...' : 'Confirm Match'}\r\n              </button>\r\n            )}\r\n\r\n            {error && <p className=\"text-sm text-red-600 mt-2\">{error}</p>}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 870, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/src/components/MatchList.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { Heart, AlertCircle } from 'lucide-react';\r\nimport MatchCard from './MatchCard';\r\n\r\ninterface MatchData {\r\n  id: number;\r\n  matchScore: number;\r\n  status: 'pending' | 'confirmed' | 'rejected';\r\n  lostItem: {\r\n    id: number;\r\n    title: string;\r\n    description: string;\r\n    category: string;\r\n    imageUrls: string[];\r\n    locationLost?: string;\r\n    locationFound?: string;\r\n    dateLost?: string;\r\n    dateFound?: string;\r\n    userId: number;\r\n    user: {\r\n      id: number;\r\n      name: string;\r\n      email: string;\r\n      profileImage?: string;\r\n    };\r\n  };\r\n  foundItem: {\r\n    id: number;\r\n    title: string;\r\n    description: string;\r\n    category: string;\r\n    imageUrls: string[];\r\n    locationLost?: string;\r\n    locationFound?: string;\r\n    dateLost?: string;\r\n    dateFound?: string;\r\n    userId: number;\r\n    user: {\r\n      id: number;\r\n      name: string;\r\n      email: string;\r\n      profileImage?: string;\r\n    };\r\n  };\r\n}\r\n\r\ninterface MatchListProps {\r\n  userId: number;\r\n  title?: string;\r\n  showOnlyPending?: boolean;\r\n}\r\n\r\nexport default function MatchList({\r\n  userId,\r\n  title = 'Your Matches',\r\n  showOnlyPending = false,\r\n}: MatchListProps) {\r\n  const [matches, setMatches] = useState<MatchData[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    fetchMatches();\r\n  }, []);\r\n\r\n  const fetchMatches = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      const response = await fetch('/api/match/list');\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch matches');\r\n      }\r\n\r\n      const data = await response.json();\r\n      let filteredMatches = data.matches || [];\r\n\r\n      if (showOnlyPending) {\r\n        filteredMatches = filteredMatches.filter((m: MatchData) => m.status === 'pending');\r\n      }\r\n\r\n      setMatches(filteredMatches);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to load matches');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleConfirm = async (matchId: number) => {\r\n    try {\r\n      const response = await fetch('/api/match/confirm', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ matchId }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to confirm match');\r\n      }\r\n\r\n      // Refresh matches list\r\n      await fetchMatches();\r\n    } catch (err) {\r\n      throw err;\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <div className=\"inline-block\">\r\n          <div className=\"w-12 h-12 rounded-full border-4 border-gray-200 border-t-indigo-600 animate-spin\" />\r\n        </div>\r\n        <p className=\"text-gray-600 mt-4\">Loading matches...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 flex items-gap-3\">\r\n        <AlertCircle className=\"w-5 h-5 text-red-600 flex-shrink-0\" />\r\n        <div>\r\n          <p className=\"font-semibold text-red-900\">Error</p>\r\n          <p className=\"text-sm text-red-700\">{error}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (matches.length === 0) {\r\n    return (\r\n      <div className=\"text-center py-12\">\r\n        <div className=\"text-gray-400 mb-3 flex justify-center\">\r\n          <Heart className=\"w-16 h-16\" />\r\n        </div>\r\n        <h3 className=\"text-xl font-semibold text-gray-800 mb-2\">No matches yet</h3>\r\n        <p className=\"text-gray-600\">\r\n          {showOnlyPending\r\n            ? 'No pending matches. Check back soon!'\r\n            : 'Post an item to start finding matches'}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2\">\r\n        <Heart className=\"w-6 h-6 text-red-600\" />\r\n        {title}\r\n      </h2>\r\n\r\n      <div className=\"space-y-6\">\r\n        {matches.map((match) => {\r\n          const isLostItemOwner = match.lostItem.userId === userId;\r\n\r\n          return (\r\n            <MatchCard\r\n              key={match.id}\r\n              matchId={match.id}\r\n              score={match.matchScore}\r\n              lostItem={match.lostItem}\r\n              foundItem={match.foundItem}\r\n              isLostItemOwner={isLostItemOwner}\r\n              status={match.status}\r\n              onConfirm={handleConfirm}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;;;AAJA;;;;AAsDe,SAAS,UAAU,EAChC,MAAM,EACN,QAAQ,cAAc,EACtB,kBAAkB,KAAK,EACR;;IACf,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAc,EAAE;IACtD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAgB;IAElD,IAAA,8NAAS;+BAAC;YACR;QACF;8BAAG,EAAE;IAEL,MAAM,eAAe;QACnB,IAAI;YACF,WAAW;YACX,SAAS;YAET,MAAM,WAAW,MAAM,MAAM;YAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,IAAI,kBAAkB,KAAK,OAAO,IAAI,EAAE;YAExC,IAAI,iBAAiB;gBACnB,kBAAkB,gBAAgB,MAAM,CAAC,CAAC,IAAiB,EAAE,MAAM,KAAK;YAC1E;YAEA,WAAW;QACb,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAChD,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,gBAAgB,OAAO;QAC3B,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,sBAAsB;gBACjD,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAQ;YACjC;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,uBAAuB;YACvB,MAAM;QACR,EAAE,OAAO,KAAK;YACZ,MAAM;QACR;IACF;IAEA,IAAI,SAAS;QACX,qBACE,iPAAC;YAAI,WAAU;;8BACb,iPAAC;oBAAI,WAAU;8BACb,cAAA,iPAAC;wBAAI,WAAU;;;;;;;;;;;8BAEjB,iPAAC;oBAAE,WAAU;8BAAqB;;;;;;;;;;;;IAGxC;IAEA,IAAI,OAAO;QACT,qBACE,iPAAC;YAAI,WAAU;;8BACb,iPAAC,0RAAW;oBAAC,WAAU;;;;;;8BACvB,iPAAC;;sCACC,iPAAC;4BAAE,WAAU;sCAA6B;;;;;;sCAC1C,iPAAC;4BAAE,WAAU;sCAAwB;;;;;;;;;;;;;;;;;;IAI7C;IAEA,IAAI,QAAQ,MAAM,KAAK,GAAG;QACxB,qBACE,iPAAC;YAAI,WAAU;;8BACb,iPAAC;oBAAI,WAAU;8BACb,cAAA,iPAAC,oQAAK;wBAAC,WAAU;;;;;;;;;;;8BAEnB,iPAAC;oBAAG,WAAU;8BAA2C;;;;;;8BACzD,iPAAC;oBAAE,WAAU;8BACV,kBACG,yCACA;;;;;;;;;;;;IAIZ;IAEA,qBACE,iPAAC;;0BACC,iPAAC;gBAAG,WAAU;;kCACZ,iPAAC,oQAAK;wBAAC,WAAU;;;;;;oBAChB;;;;;;;0BAGH,iPAAC;gBAAI,WAAU;0BACZ,QAAQ,GAAG,CAAC,CAAC;oBACZ,MAAM,kBAAkB,MAAM,QAAQ,CAAC,MAAM,KAAK;oBAElD,qBACE,iPAAC,iMAAS;wBAER,SAAS,MAAM,EAAE;wBACjB,OAAO,MAAM,UAAU;wBACvB,UAAU,MAAM,QAAQ;wBACxB,WAAW,MAAM,SAAS;wBAC1B,iBAAiB;wBACjB,QAAQ,MAAM,MAAM;wBACpB,WAAW;uBAPN,MAAM,EAAE;;;;;gBAUnB;;;;;;;;;;;;AAIR;GA9HwB;KAAA","debugId":null}}]
}