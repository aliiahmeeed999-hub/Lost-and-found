{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/src/components/LogoutButton.jsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { LogOut } from 'lucide-react';\r\n\r\nexport default function LogoutButton() {\r\n  const router = useRouter();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      // ========================================\r\n      // CLEAR CLIENT-SIDE DATA\r\n      // ========================================\r\n      \r\n      // Clear localStorage\r\n      localStorage.removeItem('user');\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('authToken');\r\n      \r\n      // Clear sessionStorage\r\n      sessionStorage.removeItem('user');\r\n      sessionStorage.removeItem('token');\r\n      sessionStorage.removeItem('authToken');\r\n      \r\n      // Clear all localStorage items (just to be safe)\r\n      try {\r\n        const keys = Object.keys(localStorage);\r\n        keys.forEach(key => {\r\n          if (key.includes('auth') || key.includes('user') || key.includes('token')) {\r\n            localStorage.removeItem(key);\r\n          }\r\n        });\r\n      } catch (e) {\r\n        console.warn('Could not clear all localStorage items:', e);\r\n      }\r\n\r\n      // ========================================\r\n      // CALL LOGOUT API\r\n      // ========================================\r\n      \r\n      // Call the logout API endpoint\r\n      const response = await fetch('/api/auth/logout', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        // Prevent caching of this request\r\n        cache: 'no-store',\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to logout');\r\n      }\r\n\r\n      // ========================================\r\n      // REDIRECT AND REFRESH\r\n      // ========================================\r\n      \r\n      // Redirect to login page\r\n      router.push('/login');\r\n      \r\n      // Force refresh to clear all server-side session data\r\n      router.refresh();\r\n      \r\n      // Additional measure: clear browser history for protected pages\r\n      if (window.history && window.history.length > 1) {\r\n        window.history.replaceState(null, '', '/login');\r\n      }\r\n    } catch (err) {\r\n      console.error('Logout error:', err);\r\n      setError(err.message || 'Failed to logout. Please try again.');\r\n      \r\n      // Even if logout fails, redirect to login as a fallback\r\n      setTimeout(() => {\r\n        router.push('/login');\r\n        router.refresh();\r\n      }, 1500);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <button\r\n      onClick={handleLogout}\r\n      disabled={isLoading}\r\n      className=\"flex items-center gap-2 px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed\"\r\n      title={error ? error : 'Click to logout'}\r\n    >\r\n      <LogOut className=\"w-4 h-4\" />\r\n      {isLoading ? 'Logging out...' : 'Logout'}\r\n    </button>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,SAAS,IAAA,mMAAS;IACxB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,qQAAQ,EAAC;IAC3C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,qQAAQ,EAAC;IAEnC,MAAM,eAAe;QACnB,IAAI;YACF,aAAa;YACb,SAAS;YAET,2CAA2C;YAC3C,yBAAyB;YACzB,2CAA2C;YAE3C,qBAAqB;YACrB,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YAExB,uBAAuB;YACvB,eAAe,UAAU,CAAC;YAC1B,eAAe,UAAU,CAAC;YAC1B,eAAe,UAAU,CAAC;YAE1B,iDAAiD;YACjD,IAAI;gBACF,MAAM,OAAO,OAAO,IAAI,CAAC;gBACzB,KAAK,OAAO,CAAC,CAAA;oBACX,IAAI,IAAI,QAAQ,CAAC,WAAW,IAAI,QAAQ,CAAC,WAAW,IAAI,QAAQ,CAAC,UAAU;wBACzE,aAAa,UAAU,CAAC;oBAC1B;gBACF;YACF,EAAE,OAAO,GAAG;gBACV,QAAQ,IAAI,CAAC,2CAA2C;YAC1D;YAEA,2CAA2C;YAC3C,kBAAkB;YAClB,2CAA2C;YAE3C,+BAA+B;YAC/B,MAAM,WAAW,MAAM,MAAM,oBAAoB;gBAC/C,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,kCAAkC;gBAClC,OAAO;YACT;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,2CAA2C;YAC3C,uBAAuB;YACvB,2CAA2C;YAE3C,yBAAyB;YACzB,OAAO,IAAI,CAAC;YAEZ,sDAAsD;YACtD,OAAO,OAAO;YAEd,gEAAgE;YAChE,IAAI,OAAO,OAAO,IAAI,OAAO,OAAO,CAAC,MAAM,GAAG,GAAG;gBAC/C,OAAO,OAAO,CAAC,YAAY,CAAC,MAAM,IAAI;YACxC;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,iBAAiB;YAC/B,SAAS,IAAI,OAAO,IAAI;YAExB,wDAAwD;YACxD,WAAW;gBACT,OAAO,IAAI,CAAC;gBACZ,OAAO,OAAO;YAChB,GAAG;QACL,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,kSAAC;QACC,SAAS;QACT,UAAU;QACV,WAAU;QACV,OAAO,QAAQ,QAAQ;;0BAEvB,kSAAC,wQAAM;gBAAC,WAAU;;;;;;YACjB,YAAY,mBAAmB;;;;;;;AAGtC","debugId":null}}]
}