{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/inter_7b064e0d.module.css [app-rsc] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"className\": \"inter_7b064e0d-module__MOT0tq__className\",\n  \"variable\": \"inter_7b064e0d-module__MOT0tq__variable\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 11, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/inter_7b064e0d.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22layout.tsx%22,%22import%22:%22Inter%22,%22arguments%22:[{%22variable%22:%22--font-inter%22,%22subsets%22:[%22latin%22],%22display%22:%22swap%22}],%22variableName%22:%22inter%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'Inter', 'Inter Fallback'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,gKAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,gKAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,gKAAS,CAAC,QAAQ;AAC1C;uCAEe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/space_grotesk_4f9f433b.module.css [app-rsc] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"className\": \"space_grotesk_4f9f433b-module__fJfFLG__className\",\n  \"variable\": \"space_grotesk_4f9f433b-module__fJfFLG__variable\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["turbopack:///[next]/internal/font/google/space_grotesk_4f9f433b.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/google/cssmodule.module.css?{%22path%22:%22layout.tsx%22,%22import%22:%22Space_Grotesk%22,%22arguments%22:[{%22variable%22:%22--font-space-grotesk%22,%22subsets%22:[%22latin%22],%22display%22:%22swap%22}],%22variableName%22:%22spaceGrotesk%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'Space Grotesk', 'Space Grotesk Fallback'\",\n        fontStyle: \"normal\",\n\n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,wKAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;QACZ,WAAW;IAEf;AACJ;AAEA,IAAI,wKAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,wKAAS,CAAC,QAAQ;AAC1C;uCAEe","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/lib/auth.js"],"sourcesContent":["import bcrypt from 'bcryptjs';\r\nimport jwt from 'jsonwebtoken';\r\nimport { cookies } from 'next/headers';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';\r\n\r\nif (!process.env.JWT_SECRET) {\r\n  console.warn('⚠️ WARNING: JWT_SECRET is not set in environment variables!');\r\n}\r\n\r\n// ============================================\r\n// PASSWORD HASHING\r\n// ============================================\r\n\r\n/**\r\n * Hash a password using bcrypt\r\n * @param {string} password - Plain text password\r\n * @returns {Promise<string>} Hashed password\r\n */\r\nexport async function hashPassword(password) {\r\n  return await bcrypt.hash(password, 12);\r\n}\r\n\r\n/**\r\n * Verify a password against a hash\r\n * @param {string} password - Plain text password\r\n * @param {string} hashedPassword - Hashed password from database\r\n * @returns {Promise<boolean>} True if password matches\r\n */\r\nexport async function verifyPassword(password, hashedPassword) {\r\n  return await bcrypt.compare(password, hashedPassword);\r\n}\r\n\r\n// ============================================\r\n// JWT TOKEN MANAGEMENT\r\n// ============================================\r\n\r\n/**\r\n * Generate JWT token for a user\r\n * @param {number} userId - User ID\r\n * @param {string} email - User email\r\n * @returns {string} JWT token\r\n */\r\nexport function generateToken(userId, email) {\r\n  return jwt.sign(\r\n    { \r\n      userId, \r\n      email,\r\n      iat: Math.floor(Date.now() / 1000)\r\n    },\r\n    JWT_SECRET,\r\n    { expiresIn: '7d' } // Token expires in 7 days\r\n  );\r\n}\r\n\r\n/**\r\n * Verify and decode JWT token\r\n * @param {string} token - JWT token\r\n * @returns {object|null} Decoded token or null if invalid\r\n */\r\nexport function verifyToken(token) {\r\n  try {\r\n    return jwt.verify(token, JWT_SECRET);\r\n  } catch (error) {\r\n    console.error('Token verification failed:', error.message);\r\n    return null;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// REQUEST HELPERS\r\n// ============================================\r\n\r\n/**\r\n * Get user from request cookies (Server Component)\r\n * @returns {Promise<object|null>} User data or null\r\n */\r\nexport async function getUserFromCookies() {\r\n  const cookieStore = await cookies();\r\n  const token = cookieStore.get('token')?.value;\r\n  \r\n  if (!token) {\r\n    return null;\r\n  }\r\n  \r\n  return verifyToken(token);\r\n}\r\n\r\n/**\r\n * Require authentication (throw error if not authenticated)\r\n * @returns {Promise<object>} User data\r\n * @throws {Error} If not authenticated\r\n */\r\nexport async function requireAuth() {\r\n  const user = await getUserFromCookies();\r\n  \r\n  if (!user) {\r\n    throw new Error('Authentication required');\r\n  }\r\n  \r\n  return user;\r\n}\r\n\r\n// ============================================\r\n// VALIDATION\r\n// ============================================\r\n\r\n/**\r\n * Validate email format\r\n * @param {string} email - Email to validate\r\n * @returns {boolean} True if valid\r\n */\r\nexport function isValidEmail(email) {\r\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n  return emailRegex.test(email);\r\n}\r\n\r\n/**\r\n * Validate password strength\r\n * @param {string} password - Password to validate\r\n * @returns {object} { valid: boolean, errors: string[] }\r\n */\r\nexport function validatePassword(password) {\r\n  const errors = [];\r\n  \r\n  if (password.length < 8) {\r\n    errors.push('Password must be at least 8 characters long');\r\n  }\r\n  \r\n  if (!/[A-Z]/.test(password)) {\r\n    errors.push('Password must contain at least one uppercase letter');\r\n  }\r\n  \r\n  if (!/[a-z]/.test(password)) {\r\n    errors.push('Password must contain at least one lowercase letter');\r\n  }\r\n  \r\n  if (!/[0-9]/.test(password)) {\r\n    errors.push('Password must contain at least one number');\r\n  }\r\n  \r\n  return {\r\n    valid: errors.length === 0,\r\n    errors\r\n  };\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAE7C,IAAI,CAAC,QAAQ,GAAG,CAAC,UAAU,EAAE;IAC3B,QAAQ,IAAI,CAAC;AACf;AAWO,eAAe,aAAa,QAAQ;IACzC,OAAO,MAAM,gMAAM,CAAC,IAAI,CAAC,UAAU;AACrC;AAQO,eAAe,eAAe,QAAQ,EAAE,cAAc;IAC3D,OAAO,MAAM,gMAAM,CAAC,OAAO,CAAC,UAAU;AACxC;AAYO,SAAS,cAAc,MAAM,EAAE,KAAK;IACzC,OAAO,oMAAG,CAAC,IAAI,CACb;QACE;QACA;QACA,KAAK,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK;IAC/B,GACA,YACA;QAAE,WAAW;IAAK,EAAE,0BAA0B;;AAElD;AAOO,SAAS,YAAY,KAAK;IAC/B,IAAI;QACF,OAAO,oMAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B,MAAM,OAAO;QACzD,OAAO;IACT;AACF;AAUO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,8LAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,UAAU;IAExC,IAAI,CAAC,OAAO;QACV,OAAO;IACT;IAEA,OAAO,YAAY;AACrB;AAOO,eAAe;IACpB,MAAM,OAAO,MAAM;IAEnB,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT;AAWO,SAAS,aAAa,KAAK;IAChC,MAAM,aAAa;IACnB,OAAO,WAAW,IAAI,CAAC;AACzB;AAOO,SAAS,iBAAiB,QAAQ;IACvC,MAAM,SAAS,EAAE;IAEjB,IAAI,SAAS,MAAM,GAAG,GAAG;QACvB,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,CAAC,QAAQ,IAAI,CAAC,WAAW;QAC3B,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,CAAC,QAAQ,IAAI,CAAC,WAAW;QAC3B,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,CAAC,QAAQ,IAAI,CAAC,WAAW;QAC3B,OAAO,IAAI,CAAC;IACd;IAEA,OAAO;QACL,OAAO,OAAO,MAAM,KAAK;QACzB;IACF;AACF","debugId":null}},
    {"offset": {"line": 172, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/src/context/AuthContext.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const AuthProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Desktop/my-project/lost-found-app/src/context/AuthContext.jsx <module evaluation>\",\n    \"AuthProvider\",\n);\nexport const useAuth = registerClientReference(\n    function() { throw new Error(\"Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Desktop/my-project/lost-found-app/src/context/AuthContext.jsx <module evaluation>\",\n    \"useAuth\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,4TAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,+FACA;AAEG,MAAM,UAAU,IAAA,4TAAuB,EAC1C;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,+FACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/src/context/AuthContext.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const AuthProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Desktop/my-project/lost-found-app/src/context/AuthContext.jsx\",\n    \"AuthProvider\",\n);\nexport const useAuth = registerClientReference(\n    function() { throw new Error(\"Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Desktop/my-project/lost-found-app/src/context/AuthContext.jsx\",\n    \"useAuth\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;;AACvE;;AACO,MAAM,eAAe,IAAA,4TAAuB,EAC/C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,2EACA;AAEG,MAAM,UAAU,IAAA,4TAAuB,EAC1C;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,2EACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 210, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 218, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/src/components/AuthWrapper.jsx"],"sourcesContent":["import { cookies } from 'next/headers';\r\nimport { verifyToken } from '@/lib/auth';\r\nimport { AuthProvider } from '@/context/AuthContext';\r\n\r\n/**\r\n * Checks if user is authenticated server-side\r\n * and returns initial user data for client\r\n */\r\nasync function getInitialUser() {\r\n  try {\r\n    const cookieStore = await cookies();\r\n    const token = cookieStore.get('token')?.value;\r\n\r\n    if (!token) {\r\n      return null;\r\n    }\r\n\r\n    const decoded = verifyToken(token);\r\n    if (!decoded) {\r\n      return null;\r\n    }\r\n\r\n    return {\r\n      userId: decoded.userId,\r\n      email: decoded.email,\r\n      iat: decoded.iat\r\n    };\r\n  } catch (error) {\r\n    console.error('Error getting initial user:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * AuthWrapper component\r\n * Wraps the app with AuthProvider and passes initial user data\r\n */\r\nexport async function AuthWrapper({ children }) {\r\n  const initialUser = await getInitialUser();\r\n\r\n  return (\r\n    <AuthProvider initialUser={initialUser}>\r\n      {children}\r\n    </AuthProvider>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAEA;;;CAGC,GACD,eAAe;IACb,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,8LAAO;QACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,UAAU;QAExC,IAAI,CAAC,OAAO;YACV,OAAO;QACT;QAEA,MAAM,UAAU,IAAA,8KAAW,EAAC;QAC5B,IAAI,CAAC,SAAS;YACZ,OAAO;QACT;QAEA,OAAO;YACL,QAAQ,QAAQ,MAAM;YACtB,OAAO,QAAQ,KAAK;YACpB,KAAK,QAAQ,GAAG;QAClB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO;IACT;AACF;AAMO,eAAe,YAAY,EAAE,QAAQ,EAAE;IAC5C,MAAM,cAAc,MAAM;IAE1B,qBACE,kSAAC,kMAAY;QAAC,aAAa;kBACxB;;;;;;AAGP","debugId":null}},
    {"offset": {"line": 269, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/7400/Desktop/my-project/lost-found-app/src/app/layout.tsx"],"sourcesContent":["import type { Metadata } from \"next\";\nimport { Inter, Space_Grotesk } from \"next/font/google\";\nimport \"./globals.css\";\nimport { AuthWrapper } from \"@/components/AuthWrapper\";\n\nconst inter = Inter({\n  variable: \"--font-inter\",\n  subsets: [\"latin\"],\n  display: \"swap\",\n});\n\nconst spaceGrotesk = Space_Grotesk({\n  variable: \"--font-space-grotesk\",\n  subsets: [\"latin\"],\n  display: \"swap\",\n});\n\nexport const metadata: Metadata = {\n  title: \"Lost & Found - Reuniting People with Their Belongings\",\n  description: \"A modern platform for reporting and finding lost items\",\n};\n\nexport default function RootLayout({\n  children,\n}: Readonly<{\n  children: React.ReactNode;\n}>) {\n  return (\n    <html lang=\"en\">\n      <body\n        className={`${inter.variable} ${spaceGrotesk.variable} font-sans antialiased`}\n      >\n        <AuthWrapper>\n          {children}\n        </AuthWrapper>\n      </body>\n    </html>\n  );\n}\n"],"names":[],"mappings":";;;;;;;;;AAGA;;;;;;AAcO,MAAM,WAAqB;IAChC,OAAO;IACP,aAAa;AACf;AAEe,SAAS,WAAW,EACjC,QAAQ,EAGR;IACA,qBACE,kSAAC;QAAK,MAAK;kBACT,cAAA,kSAAC;YACC,WAAW,GAAG,oJAAK,CAAC,QAAQ,CAAC,CAAC,EAAE,4JAAY,CAAC,QAAQ,CAAC,sBAAsB,CAAC;sBAE7E,cAAA,kSAAC,oMAAW;0BACT;;;;;;;;;;;;;;;;AAKX","debugId":null}}]
}